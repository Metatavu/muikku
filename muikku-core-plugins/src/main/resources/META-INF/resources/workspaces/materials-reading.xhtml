<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml" 
  xmlns:c="http://java.sun.com/jsp/jstl/core" 
  xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:f="http://java.sun.com/jsf/core" 
  xmlns:h="http://java.sun.com/jsf/html" 
  xmlns:m="http://www.ofw.fi/xml/2013/muikku/components-taglib.xsd"
  xmlns:composite="http://java.sun.com/jsf/composite/composite" 
  template="/workspaces/templates/workspace-materials-reading-view.xhtml">
  
  <ui:define name="viewScripts">
    <h:outputScript name="scripts/jquery.jsplumb/jquery.jsPlumb-1.7.2-min.js"/>
    <h:outputScript name="scripts/gui/muikku-connect-field-component.js"/>
    <h:outputScript name="scripts/jquery.fileupload/load-image.min.js"/>
    <h:outputScript name="scripts/jquery.fileupload/canvas-to-blob.min.js"/>
    <h:outputScript name="scripts/jquery.fileupload/jquery.iframe-transport.js"/>
    <h:outputScript name="scripts/jquery.fileupload/jquery.fileupload.js"/>
    <h:outputScript name="scripts/jquery.fileupload/jquery.fileupload-process.js"/>
    <h:outputScript name="scripts/jquery.fileupload/jquery.fileupload-image.js"/>
    <h:outputScript name="scripts/gui/muikku-file-field-component.js"/>
    <h:outputScript name="scripts/gui/workspace.js"/> 
    <h:outputScript name="scripts/gui/muikku-material-loader.js"/> 
    <h:outputScript name="scripts/gui/workspace-materials-reading.js"/> 
  </ui:define>

  <ui:define name="workspaces.materials.reading.toc">
    <div id="workspaceMaterialsReadingTOCWrapper">
      <nav id="workspaceMaterialsReadingTOCClosed">
        <div class="workspaceMaterialsReadingTOCTitle">
          <div id="workspaceMaterialsReadingTOCNavicon" class="icon-navicon workspace-materials-reading-toc-opening-button"></div>
        </div>
      </nav>
    
      <nav id="workspaceMaterialsReadingTOCOpen">
        <div class="workspace-materials-reading-TOC-title">
          <h1>Sis√§llysluettelo</h1>
          <div id="workspaceMaterialsReadingTOCPinicon" class="icon-pin"></div>
          <div id="workspaceMaterialsReadingTOCNavicon" class="icon-navicon workspace-materials-reading-toc-closing-button"></div>
        </div>
        <div class="workspace-materials-toc-content-outer">
          <div class="workspace-materials-toc-content-inner">
            <div class="workspace-materials-toc-content-scrolling">
              <ui:include src="/workspaces/templates/workspace-materials-list.xhtml">
                <ui:param name="nodes" value="#{workspaceMaterialsTOCBackingBean.getVisibleChildren(workspaceMaterialsReadingBackingBean.getRootFolder())}"/>
                <ui:param name="includeHidden" value="false"/>
              </ui:include>
              <div class="spacer"></div>
            </div>
          </div>
        </div>
      </nav>
    </div>
  </ui:define>

  <ui:define name="workspace.materials.reading.content">
    <ui:repeat var="node" value="#{workspaceMaterialsTOCBackingBean.getVisibleDescendants(workspaceMaterialsReadingBackingBean.getRootFolder())}">
      <ui:fragment rendered="#{node.materialType eq 'folder'}">
       <h2 id="page-#{node.workspaceMaterialId}" data-workspace-material-id="#{node.workspaceMaterialId}" data-material-id="#{node.materialId}" data-material-type="#{node.materialType}" data-material-title="#{node.materialTitle}" class="workspace-materials-reading-view-page folder"></h2>
      </ui:fragment>
      <ui:fragment rendered="#{node.materialType ne 'folder'}">
        <section id="page-#{node.workspaceMaterialId}" data-workspace-material-id="#{node.workspaceMaterialId}" data-material-id="#{node.materialId}" data-material-type="#{node.materialType}" data-material-title="#{node.materialTitle}" class="workspace-materials-reading-view-page"/>
      </ui:fragment>
    </ui:repeat>
    
    <input class="workspaceEntityId" type="hidden" value="#{workspaceMaterialsReadingBackingBean.workspaceEntityId}"/>
  </ui:define>
  
  <ui:define name="workspaces.materials.reading.additional.dock">
    <div id="workspaceMaterialsReadingAdditionalNavWrapper">
      <nav class="workspace-waterials-reading-additional-nav">
        <m:widgetSpaceSet>
          <m:widgetSpace name="workspaces.materials.reading.dock" keepEmpty="true" sizing="MINIMIZE" styleClass="">
            <m:widget name="workspaces-materials-reading-goback" size="1" />
            <m:widget name="workspaces-materials-reading-manage-materials" size="1" />
          </m:widgetSpace>
        </m:widgetSpaceSet>
      </nav>
    </div>
  </ui:define>

</ui:composition>
