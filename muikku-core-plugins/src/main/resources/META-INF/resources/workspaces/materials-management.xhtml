<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml" 
  xmlns:c="http://java.sun.com/jsp/jstl/core" 
  xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:f="http://java.sun.com/jsf/core" 
  xmlns:h="http://java.sun.com/jsf/html" 
  xmlns:m="http://www.ofw.fi/xml/2013/muikku/components-taglib.xsd"
  xmlns:composite="http://java.sun.com/jsf/composite/composite" 
  template="/workspaces/templates/workspace-materials-management-view.xhtml">

  <ui:define name="workspaces.materials.management.toc">
    <div id="workspaceMaterialsManagementTOCWrapper">
      <nav class="workspace-waterials-management-nav" id="workspaceMaterialsManagementNav">
        <m:widgetSpaceSet>
          <m:widgetSpace name="workspaces.materials.management.dock" keepEmpty="true" sizing="MINIMIZE" styleClass="">
            <m:widget name="workspaces-materials-full-screen-toc" size="1" />
            <m:widget name="workspaces-materials-full-screen-goback" size="1" />
            <m:widget name="workspaces-materials-full-screen-reading-materials" size="1" />
          </m:widgetSpace>
        </m:widgetSpaceSet>
      </nav>
    
      <div id="workspaceMaterialsManagementTOCContainer">
        <div class="workspace-materials-management-TOC-title">
          <h1>Sis√§llysluettelo</h1>
        </div>
        <div class="workspace-materials-toc-content-outer">
          <div class="workspace-materials-toc-content-inner">
            <div class="workspace-materials-toc-content-scrolling">
              <ul class="workspace-materials-toc-root">
                <ui:include src="/workspaces/templates/workspace-materials-list.xhtml">
                  <ui:param name="nodes" value="#{workspaceMaterialsTOCBackingBean.getChildren(workspaceMaterialsManagementBackingBean.getRootFolder())}"/>
                  <ui:param name="includeHidden" value="true"/>
                </ui:include>
              </ul>  
              <div class="spacer"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </ui:define>

  <ui:define name="workspace.materials.management.content">
    <ui:repeat var="node" value="#{workspaceMaterialsTOCBackingBean.getDescendants(workspaceMaterialsManagementBackingBean.getRootFolder())}" varStatus="vs">
      <ui:fragment rendered="#{node.materialType eq 'folder'}">
        <div class="workspace-materials-management-addpage"><span class="workspace-materials-management-line-separator"></span><a class="workspaces-materials-management-add-page icon-add" href="javascript:void(null)"><span>Add new page</span></a></div>      
        <div class="workspaces-materials-management-insert-file">
          <input type="file"/>  
        </div>
        <h2 id="page-#{node.workspaceMaterialId}" data-workspace-material-id="#{node.workspaceMaterialId}" data-material-id="#{node.materialId}" data-parent-id="#{node.parentId}" data-material-type="#{node.materialType}" data-material-title="#{node.materialTitle}" class="workspace-materials-view-page material-management-view folder" data-assignment-type="#{node.assignmentType}"></h2>
        <ui:fragment rendered="#{vs.last}">
          <div class="workspace-materials-management-addpage"><span class="workspace-materials-management-line-separator"></span><a class="workspaces-materials-management-add-page icon-add" href="javascript:void(null)"><span>Add new page</span></a></div>
          <div class="workspaces-materials-management-insert-file">
            <input type="file"/>  
          </div>
        </ui:fragment>
      </ui:fragment>
      <ui:fragment rendered="#{node.materialType ne 'folder'}">
        <div class="workspace-materials-management-addpage"><span class="workspace-materials-management-line-separator"></span><a class="workspaces-materials-management-add-page icon-add" href="javascript:void(null)"><span>Add new page</span></a></div>      
        <div class="workspaces-materials-management-insert-file">
          <input type="file"/>  
        </div>
        <section id="page-#{node.workspaceMaterialId}" data-workspace-material-id="#{node.workspaceMaterialId}" data-material-id="#{node.materialId}" data-parent-id="#{node.parentId}" data-material-type="#{node.materialType}" data-material-title="#{node.materialTitle}" class="workspace-materials-view-page material-management-view #{node.materialHidden ? 'page-hidden' : ''}" data-assignment-type="#{node.assignmentType}"/>
        <ui:fragment rendered="#{vs.last}">
          <div class="workspace-materials-management-addpage"><span class="workspace-materials-management-line-separator"></span><a class="workspaces-materials-management-add-page icon-add" href="javascript:void(null)"><span>Add new page</span></a></div>
          <div class="workspaces-materials-management-insert-file">
            <input type="file"/>  
          </div>
        </ui:fragment>
      </ui:fragment>
    </ui:repeat>
    
    <input class="workspaceEntityId" type="hidden" value="#{workspaceMaterialsManagementBackingBean.workspaceEntityId}"/>
  </ui:define>
  
</ui:composition>
