<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
    xmlns:m="http://www.ofw.fi/xml/2013/muikku/components-taglib.xsd"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:c="http://java.sun.com/jsp/jstl/core"
    xmlns:fn="http://java.sun.com/jsp/jstl/functions"
    template="/WEB-INF/templates/default.xhtml">
    
  <ui:define name="content.center.widget">
    <h:outputScript name="scripts/jshash/md5-min.js" target="head"/>

    <h:form id="chPw">
      #{i18n.text['plugin.userinfo.changePassword.oldPassword']}:
      <br/>
      <h:inputSecret id="p1" value="#{userChangePasswordBackingBean.passwordHash}" validator="#{userChangePasswordBackingBean.validateOldPassword}" />
      <h:message for="p1" />
      <br/>
      
      #{i18n.text['plugin.userinfo.changePassword.newPassword']}:
      <br/>
      <h:inputSecret id="p2" value="#{userChangePasswordBackingBean.newPasswordHash}" binding="#{p2}" />
      <h:message for="p2" />
      <br/>
      
      #{i18n.text['plugin.userinfo.changePassword.newPasswordAgain']}:
      <br/>
      <h:inputSecret id="p3" value="#{userChangePasswordBackingBean.newPasswordHashAgain}" validator="#{userChangePasswordBackingBean.validateNewPasswords}">
        <f:attribute name="p2" value="#{p2}" />
      </h:inputSecret>
      <h:message for="p3" />
      <br/>
      
      <h:commandButton onclick="$('#chPw\\:p1').val(hex_md5($('#chPw\\:p1').val())); $('#chPw\\:p2').val(hex_md5($('#chPw\\:p2').val())); $('#chPw\\:p3').val(hex_md5($('#chPw\\:p3').val())); return true;" value="#{i18n.text['plugin.userinfo.changePassword.changePassword']}" action="#{userChangePasswordBackingBean.changePassword()}" />
    </h:form>
  </ui:define>

</ui:composition>
