<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
    xmlns:m="http://www.ofw.fi/xml/2013/muikku/components-taglib.xsd"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:c="http://java.sun.com/jsp/jstl/core"
    xmlns:fn="http://java.sun.com/jsp/jstl/functions"
    template="/WEB-INF/templates/default.xhtml">
    
    
	   <ui:define name="content.center.widget">
	     <h:outputScript name="scripts/jshash/md5-min.js" target="head"/>
	     <h:outputScript name="scripts/gui/notificationsettings.js" target="head"/>
	


       <div class="ps-edit-user co-widget">

        <div class="widget ps-edit-container-notifications">
          <h5>Lokalisoi: "Herätteet"</h5>
          <table border="1" id="userNotifierSettingsTable">
            <tr>
              <td></td>
              
              <c:forEach var="method" items="#{userNotifierSettingsBackingBean.listMethods()}">
                <td>#{method.displayName}</td>
              </c:forEach>
            </tr>
            
            <c:forEach var="action" items="#{userNotifierSettingsBackingBean.listActions()}">
              <tr>
                <td>#{action.displayName}</td>
              
                <c:forEach var="method" items="#{userNotifierSettingsBackingBean.listMethods()}">
                  <td>
                    <input type="hidden" name="methodName" value="#{method.name}"/>
                    <input type="hidden" name="actionName" value="#{action.name}"/>
                    
                    <c:choose>
                      <c:when test="#{!userNotifierSettingsBackingBean.supportsMethod(action, method)}">
                        <input type="checkbox" disabled="disabled"/>
                      </c:when>
                      <c:when test="#{userNotifierSettingsBackingBean.isSelected(action, method)}">
                        <input type="checkbox" class="userNotifierSettingsCheckbox" name="chkbx.#{methodName}.#{actionName}" checked="checked"/>
                      </c:when>
                      <c:otherwise>
                        <input type="checkbox" class="userNotifierSettingsCheckbox" name="chkbx.#{methodName}.#{actionName}"/>
                      </c:otherwise>
                    </c:choose>
                  </td>            
                </c:forEach>
              </tr>
            </c:forEach>
          </table>
        </div>       

   
		      <ui:repeat var="email" value="#{editUserInfoBackingBean.listUserEmails()}">
		        <div class="ps-edit-mail">
 		          <div class="ps-edit-container-mail">
			          <h5>Lokalisoi: "Vaihda sähköpostiosoitteesi"</h5>
			          
				        <h:form rendered="#{!userEmailChangeBackingBean.hasPendingEmailChange(email)}">
				          <h:outputLabel id="currentEmailLabel" value="Lokalisoi: Nykyinen sähköpostisi: #{email.address} " />
			            <h:outputLabel id="newAddressLabel" value="Lokalisoi: New address" />
			            <h:inputText value="#{userEmailChangeBackingBean.newEmail}" />
			            <h:commandButton action="#{userEmailChangeBackingBean.createUserEmailChange(email)}" value="Change" />
			          </h:form>
		
			          <ui:fragment rendered="#{userEmailChangeBackingBean.hasPendingEmailChange(email)}">
			           <h:outputLabel id="newAddressLabel" value="Lokalisoi:Change pending confirmation." />
			          </ui:fragment>        
		          </div>
		        </div>
		      </ui:repeat>        
		      
		      
		      

			    <div class="ps-edit-password">
			      <div class="ps-edit-container-password">
              <h5>Lokalisoi: "Vaihda salasanasi"</h5>			      
			        <h:form id="chPw">
			          <h:outputLabel value="#{i18n.text['plugin.userinfo.changePassword.oldPassword']}:" />
			  
			          <h:inputSecret id="p1" value="#{userChangePasswordBackingBean.passwordHash}" validator="#{userChangePasswordBackingBean.validateOldPassword}" />
			          <h:message for="p1" />
			          
			          <h:outputLabel value="#{i18n.text['plugin.userinfo.changePassword.newPassword']}:" />
			  
			          <h:inputSecret id="p2" value="#{userChangePasswordBackingBean.newPasswordHash}" binding="#{p2}" />
			          <h:message for="p2" />
			  
			          <h:outputLabel value="#{i18n.text['plugin.userinfo.changePassword.newPasswordAgain']}:" />
			  
			          <h:inputSecret id="p3" value="#{userChangePasswordBackingBean.newPasswordHashAgain}" validator="#{userChangePasswordBackingBean.validateNewPasswords}">
			            <f:attribute name="p2" value="#{p2}" />
			          </h:inputSecret>
			          
			          <h:message for="p3" />
			  
			          <h:commandButton onclick="$('#chPw\\:p1').val(hex_md5($('#chPw\\:p1').val())); $('#chPw\\:p2').val(hex_md5($('#chPw\\:p2').val())); $('#chPw\\:p3').val(hex_md5($('#chPw\\:p3').val())); return true;" value="#{i18n.text['plugin.userinfo.changePassword.changePassword']}" action="#{userChangePasswordBackingBean.changePassword()}" />
			        </h:form>
			      </div>
			    </div>  		      
<!-- 
      
    
        <div class="ps-edit-user-picture">

        </div>
        
        <div class="ps-edit-user-newPicture">

        </div>

        <div class="ps-edit-user-contacts">

        </div>
 
        
        <div class="ps-edit-user-wall">


        </div>
   -->      
      </div>

	  </ui:define>


</ui:composition>
