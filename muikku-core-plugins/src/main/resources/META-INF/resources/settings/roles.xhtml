<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:f="http://java.sun.com/jsf/core"
  xmlns:h="http://java.sun.com/jsf/html" template="/settings/template.xhtml">
  
  <ui:define name="content.center">
   <div class="se-container se-roles">
    <h4>Muikku Roles</h4>
    
    <h:panelGroup layout="block" id="entities-container">
      <h:form>
        <h:dataTable id="roles-table" value="#{rolesSettingsViewBackingBean.roleEntities}" var="roleEntity" style="width:100%">
          <f:facet name="header">
            <h:outputText value="All Roles" />
          </f:facet>
          
          <h:column>
            <f:facet name="header">
              <h:outputText value="Identifier" />
            </f:facet>
            <h:outputText value="#{roleEntity.id}" />
          </h:column>
          
          <h:column>
            <f:facet name="header">
              <h:outputText value="Name" />
            </f:facet>
            <h:outputText value="#{roleEntity.name}" />
          </h:column>
          
          <f:facet name="footer">
            <h:outputText value="Count: #{rolesSettingsViewBackingBean.roleEntities.size()}" />
          </f:facet>
        </h:dataTable>
        
      </h:form>
    </h:panelGroup>
    
    <br/>
    <h4>Roles from School Data</h4>
    
    <h:panelGroup layout="block" id="roles-container">
      <h:form>
        <h:dataTable id="roles-table" value="#{rolesSettingsViewBackingBean.roles}" var="role" style="width:100%">
          <f:facet name="header">
            <h:outputText value="All Roles" />
          </f:facet>
          
          <h:column>
            <f:facet name="header">
              <h:outputText value="Data Source" />
            </f:facet>
            <h:outputText value="#{role.schoolDataSource}" />
          </h:column>
          
          <h:column>
            <f:facet name="header">
              <h:outputText value="Identifier" />
            </f:facet>
            <h:outputText value="#{role.identifier}" />
          </h:column>
          
          <h:column>
            <f:facet name="header">
              <h:outputText value="Name" />
            </f:facet>
            <h:outputText value="#{role.name}" />
          </h:column>
          
          <h:column>
            <f:facet name="header">
              <h:outputText value="Muikku Role" />
            </f:facet>
            
            <h:selectOneMenu value="#{role.entityId}">
              <f:selectItems value="#{rolesSettingsViewBackingBean.getRoleSelectItems(role.type)}"/>
            </h:selectOneMenu>
          </h:column>
          
          <f:facet name="footer">
            <h:outputText value="Count: #{rolesSettingsViewBackingBean.roles.size()}" />
          </f:facet>
        </h:dataTable>
        
        <h:commandButton action="#{rolesSettingsViewBackingBean.saveRoles}" value="Save"/>
          
      </h:form>
    </h:panelGroup>
    
   </div>   
  </ui:define>

</ui:composition>
