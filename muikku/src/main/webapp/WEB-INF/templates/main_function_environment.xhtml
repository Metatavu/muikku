<ui:composition xmlns="http://www.w3.org/1999/xhtml" 
  xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:jsf="http://xmlns.jcp.org/jsf"
  template="base.xhtml">
  
  <!-- Main function environment requires three paramenters, stylesheet (the css),
    controller (the js) and activeTrail (the active page)  -->
  <!-- Main function environment requires one define, content -->
  
  <ui:define name="scripts">
    <script defer="defer" jsf:name="#{controller}"/>
  </ui:define>
  
  <ui:define name="styles">
    <link rel="stylesheet" type="text/css" href="#{stylesheet}" />
  </ui:define>
  
  <ui:define name="body">
    
    <div id="generic-environment">
      <nav class="main-function navbar">
        <div class="navbar-wrapper">
          <div class="navbar-logo"></div>
  
          <div class="navbar-items">
            <ul class="navbar-items-container">
              <li class="navbar-item main-function-navbar-item-menu-button">
                <a class="main-function link link-icon link-full generic-environment-interact-show-menu">
                  <span class="icon icon-navicon"></span>
                </a>
              </li>
              
              <!-- HOME -->
              <li class="navbar-item">
                <a jsf:outcome="/index.jsf" class="main-function link link-icon link-full #{activeTrail eq 'index' ? 'active' : ''}"
                  title="#{i18n.text['plugin.home.home']}">
                  <span class="icon icon-home"/>
                </a>
              </li>
              
              <!-- COURSEPICKER -->
              <li class="navbar-item">
                <a jsf:outcome="/jsf/coursepicker/index.jsf"
                  class="main-function link link-icon link-full #{activeTrail eq 'coursepicker' ? 'active' : ''}"
                  title="#{i18n.text['plugin.coursepicker.coursepicker']}">
                  <span class="icon icon-books"/>
                </a>
              </li>
              
              <!-- COMMUNICATOR -->
              <ui:fragment rendered="#{sessionBackingBean.loggedIn}">
                <li class="navbar-item">
                  <a jsf:outcome="/jsf/communicator/index.jsf"
                    class="main-function link link-icon link-full #{activeTrail eq 'communicator' ? 'active' : ''}"
                    title="#{i18n.text['plugin.communicator.communicator']}">
                     <span class="icon icon-envelope"/>
                  </a>
                </li>
                
                <!-- DISCUSSION -->
                <ui:fragment rendered="#{sessionBackingBean.hasEnvironmentPermission('FORUM_ACCESSENVIRONMENTFORUM')}">
                  <li class="navbar-item">
                    <a jsf:outcome="/jsf/discussion/index.jsf"
                      class="main-function link link-icon link-full #{activeTrail eq 'discussion' ? 'active' : ''}"
                      title="#{i18n.text['plugin.discussion.discussion']}">
                      <span class="icon icon-bubble"/>
                    </a>
                  </li>
                 </ui:fragment>
              </ui:fragment>
              
              <!-- GUIDER -->
              <ui:fragment rendered="#{sessionBackingBean.hasEnvironmentPermission('GUIDER_VIEW')}">
                <li class="navbar-item">
                  <a jsf:outcome="/jsf/guider/index.jsf"
                    class="main-function link link-icon link-full #{activeTrail eq 'guider' ? 'active' : ''}"
                    title="#{i18n.text['plugin.guider.guider']}">
                    <span class="icon icon-members"/>
                  </a>
                </li>
              </ui:fragment>
              
              <!-- TRANSCRIPT of RECORDS -->
              <ui:fragment rendered="#{sessionBackingBean.hasEnvironmentPermission('TRANSCRIPT_OF_RECORDS_VIEW')}">
                <li class="navbar-item">
                  <a jsf:outcome="/jsf/records/index.jsf"
                    class="main-function link link-icon link-full #{activeTrail eq 'records' ? 'active' : ''}"
                    title="#{i18n.text['plugin.records.records']}">
                    <span class="icon icon-profile"/>
                  </a>
                </li>
              </ui:fragment>
              
              <!-- EVALUATION -->
              <ui:fragment rendered="#{sessionBackingBean.hasEnvironmentPermission('EVALUATION_VIEW_INDEX')}">
                <li class="navbar-item">
                  <a jsf:outcome="/jsf/evaluation/main-view.jsf"
                    class="main-function link link-icon link-full"
                    title="#{i18n.text['plugin.evaluation.evaluation']}">
                    <span class="icon icon-evaluate"/>
                  </a>
                </li>
              </ui:fragment>
              
              <!-- ANNOUNCER -->
              <ui:fragment rendered="#{sessionBackingBean.hasEnvironmentPermission('ANNOUNCER_TOOL')}">
                <li class="navbar-item">
                  <a jsf:outcome="/jsf/announcer/index.jsf"
                    class="main-function link link-icon link-full #{activeTrail eq 'announcer' ? 'active' : ''}"
                    title="#{i18n.text['plugin.announcer.announcer']}">
                    <span class="icon icon-announcer"/>
                  </a>
                </li>
              </ui:fragment>
              
            </ul>
          </div>
          <div class="navbar-default-options">
            <div class="navbar-default-options-container">
              <a class="main-function button-pill main-function-button-pill-search generic-environment-interact-search" style="display:none;">
                <span class="icon icon-search"></span>
              </a>
              
              <ui:fragment rendered="#{sessionBackingBean.loggedIn}">
                <a class="main-function button-pill main-function-button-pill-profile generic-environment-interact-show-profile-menu">
                  <object class="embbed embbed-full"
                    data="/rest/user/files/user/#{sessionBackingBean.loggedUserId}/identifier/profile-image-96"
                    type="image/jpeg">
                    <span class="icon icon-user"></span>
                  </object>
                </a>
                <div class="main-function dropdown main-function-dropdown-profile-menu" id="generic-environment-profile-menu">
                  <div class="dropdown-container">
                    <div class="dropdown-item">
                      <a class="main-function link link-full main-function-link-profile-menu"
                        jsf:outcome="/jsf/profile/profile.jsf">
                        <span class="icon icon-user"></span>
                        <span>#{i18n.text['plugin.profile.links.personal']}</span>
                      </a>
                    </div>
                    <div class="dropdown-item">
                      <a class="main-function link link-full main-function-link-profile-menu">
                        <span class="icon icon-forgotpassword"></span>
                        <span>#{i18n.text['plugin.footer.instructions']}</span>
                      </a>
                    </div>
                    <div class="dropdown-item">
                      <a class="main-function link link-full main-function-link-profile-menu">
                        <span class="icon icon-helpdesk"></span>
                        <span>#{i18n.text['plugin.home.helpdesk']}</span>
                      </a>
                    </div>
                    <h:form>
                      <div class="dropdown-item">
                        <a jsf:action="#{logoutWidgetBackingBean.logout}"
                          class="main-function link link-full main-function-link-profile-menu">
                          <span class="icon icon-signout"></span>
                          <span>#{i18n.text['plugin.logout.logout']}</span>
                        </a>
                      </div>
                    </h:form>
                  </div>
                </div>
              </ui:fragment>
              
              <a class="main-function button-pill main-function-button-pill-language generic-environment-interact-show-language-picker">
                <span>#{languageWidgetBackingBean.language}</span>
              </a>
              <h:form class="main-function dropdown main-function-dropdown-language-picker" id="generic-environment-language-picker">
                <div class="dropdown-container">
                  <ui:repeat value="#{i18n.languages}" var="locale">
                    <div class="dropdown-item">
                      <a jsf:action="#{languageWidgetBackingBean.setLanguage(locale)}"
                        class="main-function link link-full main-function-link-language-picker">
                        <span>#{i18n.text['plugin.navigation.language.' .concat(locale)]}</span>
                      </a>
                    </div>
                  </ui:repeat>
                </div>
              </h:form>
            </div>
          </div>
        </div>
      </nav>
      <div class="main-function menu" id="generic-environment-menu">
        <div class="menu-container">
          <div class="menu-header">
            <div class="menu-logo"></div>
            <div class="menu-header-button-close icon icon-arrow-left"></div>
          </div>
          <div class="menu-body">
            <ul class="menu-items">
              <li class="menu-item">
                <a jsf:outcome="/index.jsf" class="main-function link link-full main-function-link-menu #{activeTrail eq 'index' ? 'active' : ''}">
                  <span class="icon icon-home"/>
                  #{i18n.text['plugin.home.home']}
                </a>
              </li>
              <li class="menu-item">
                <a jsf:outcome="/jsf/coursepicker/index.jsf"
                  class="main-function link link-full main-function-link-menu #{activeTrail eq 'coursepicker' ? 'active' : ''}">
                  <span class="icon icon-books"/>
                  #{i18n.text['plugin.coursepicker.coursepicker']}
                </a>
              </li>
              <ui:fragment rendered="#{sessionBackingBean.loggedIn}">
                <li class="menu-item">
                  <a jsf:outcome="/jsf/communicator/index.jsf"
                    class="main-function link link-full main-function-link-menu #{activeTrail eq 'communicator' ? 'active' : ''}">
                     <span class="icon icon-envelope"/>
                     #{i18n.text['plugin.communicator.communicator']}
                  </a>
                </li>
                <ui:fragment rendered="#{sessionBackingBean.hasEnvironmentPermission('FORUM_ACCESSENVIRONMENTFORUM')}">
                  <li class="menu-item">
                    <a jsf:outcome="/jsf/discussion/index.jsf"
                      class="main-function link link-full main-function-link-menu #{activeTrail eq 'discussion' ? 'active' : ''}">
                      <span class="icon icon-bubble"/>
                      #{i18n.text['plugin.forum.forum']}
                    </a>
                  </li>
                </ui:fragment>
              </ui:fragment>
              <ui:fragment rendered="#{sessionBackingBean.hasEnvironmentPermission('GUIDER_VIEW')}">
                <li class="menu-item">
                  <a jsf:outcome="/jsf/guider/index.jsf"
                    class="main-function link link-full main-function-link-menu #{activeTrail eq 'guider' ? 'active' : ''}">
                    <span class="icon icon-members"/>
                    #{i18n.text['plugin.guider.guider']}
                  </a>
                </li>
              </ui:fragment>
              <ui:fragment rendered="#{sessionBackingBean.hasEnvironmentPermission('TRANSCRIPT_OF_RECORDS_VIEW')}">
                <li class="menu-item">
                  <a jsf:outcome="/jsf/records/index.jsf"
                    class="main-function link link-full main-function-link-menu #{activeTrail eq 'records' ? 'active' : ''}">
                    <span class="icon icon-profile"/>
                    #{i18n.text['plugin.records.records']}
                  </a>
                </li>
              </ui:fragment>
              <ui:fragment rendered="#{sessionBackingBean.hasEnvironmentPermission('EVALUATION_VIEW_INDEX')}">
                <li class="menu-item">
                  <a jsf:outcome="/jsf/evaluation/main-view.jsf"
                    class="main-function link link-full main-function-link-menu">
                    <span class="icon icon-evaluate"/>
                    #{i18n.text['plugin.evaluation.evaluation']}
                  </a>
                </li>
              </ui:fragment>
              <ui:fragment rendered="#{sessionBackingBean.hasEnvironmentPermission('ANNOUNCER_TOOL')}">
                <li class="menu-item">
                  <a jsf:outcome="/jsf/announcer/index.jsf"
                    class="main-function link link-full main-function-link-menu #{activeTrail eq 'announcer' ? 'active' : ''}">
                    <span class="icon icon-announcer"/>
                    #{i18n.text['plugin.announcer.announcer']}
                  </a>
                </li>
              </ui:fragment>
              <ui:fragment rendered="#{sessionBackingBean.loggedIn}">
                <li class="menu-item menu-item-space"></li>
                <li class="menu-item">
                  <a class="main-function link link-full main-function-link-menu main-function-link-menu-profile"
                    jsf:outcome="/jsf/profile/profile.jsf">
                    <object class="embbed embbed-profile-image"
                      data="/rest/user/files/user/#{sessionBackingBean.loggedUserId}/identifier/profile-image-96"
                      type="image/jpeg">
                      <span class="icon icon-user"></span>
                    </object>
                    #{i18n.text['plugin.profile.profile']}
                  </a>
                </li>
                <li class="menu-item">
                  <a class="main-function link link-full main-function-link-menu main-function-link-menu-instructions">
                    <span class="icon icon-forgotpassword"/>
                    #{i18n.text['plugin.footer.instructions']}
                  </a>
                </li>
                <li class="menu-item">
                  <a class="main-function link link-full main-function-link-menu main-function-link-menu-helpdesk">
                    <span class="icon icon-helpdesk"></span>
                    #{i18n.text['plugin.home.helpdesk']}
                  </a>
                </li>
                <h:form>
                  <li class="menu-item">
                    <a jsf:action="#{logoutWidgetBackingBean.logout}"
                      class="main-function link link-full main-function-link-menu main-function-link-menu-logout">
                      <span class="icon icon-signout"></span>
                      #{i18n.text['plugin.logout.logout']}
                    </a>
                  </li>
                </h:form>
              </ui:fragment>
            </ul>
          </div>
        </div>
      </div>
    </div>
    
    <ui:insert name="content"/>
    
  </ui:define>
  
</ui:composition>
