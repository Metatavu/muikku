insert into AuthSource (name, strategy) values ('Pyramus', 'pyramusoauth');
insert into PluginSettingKey(name, plugin) select 'oauth.clientId', 'pyramus-oauth' from PluginSettingKey where plugin = 'pyramus-oauth' and name = 'oauth.clientId' having count(*) = 0;
insert into PluginSettingKey(name, plugin) select 'oauth.clientSecret', 'pyramus-oauth' from PluginSettingKey where plugin = 'pyramus-oauth' and name = 'oauth.clientSecret' having count(*) = 0;
insert into PluginSettingKey(name, plugin) select 'oauth.redirectUrl', 'pyramus-oauth' from PluginSettingKey where plugin = 'pyramus-oauth' and name = 'oauth.redirectUrl' having count(*) = 0;
insert into PluginSettingKey(name, plugin) select 'oauth.logoutUrl', 'pyramus-oauth' from PluginSettingKey where plugin = 'pyramus-oauth' and name = 'oauth.logoutUrl' having count(*) = 0;
insert into PluginSettingKey(name, plugin) select 'oauth.authUrl', 'pyramus-oauth' from PluginSettingKey where plugin = 'pyramus-oauth' and name = 'oauth.authUrl' having count(*) = 0;
insert into PluginSettingKey(name, plugin) select 'oauth.tokenUri', 'pyramus-oauth' from PluginSettingKey where plugin = 'pyramus-oauth' and name = 'oauth.tokenUri' having count(*) = 0;
insert into PluginSettingKey(name, plugin) select 'oauth.whoamiUrl', 'pyramus-oauth' from PluginSettingKey where plugin = 'pyramus-oauth' and name = 'oauth.whoamiUrl' having count(*) = 0;
insert into PluginSetting (value, key_id) select '76f3aaf5-4c92-4527-971f-49c7491df8b1', (select id from PluginSettingKey where plugin = 'pyramus-oauth' and name = 'oauth.clientId') from PluginSetting where key_id = (select id from PluginSettingKey where plugin = 'pyramus-oauth' and name = 'oauth.clientId') having count(*) = 0;
insert into PluginSetting (value, key_id) select 'ckel7XjEEd6Ypb1kl2a6gmZK0cuZognBXNqhTMP0Xc5WznKMdJSumn0odYkxyUjbZRoc1wnCG94MK45l', (select id from PluginSettingKey where plugin = 'pyramus-oauth' and name = 'oauth.clientSecret') from PluginSetting where key_id = (select id from PluginSettingKey where plugin = 'pyramus-oauth' and name = 'oauth.clientSecret') having count(*) = 0;
insert into PluginSetting (value, key_id) select 'https://m3demo.otavanopisto.fi/login?_stg=rsp', (select id from PluginSettingKey where plugin = 'pyramus-oauth' and name = 'oauth.redirectUrl') from PluginSetting where key_id = (select id from PluginSettingKey where plugin = 'pyramus-oauth' and name = 'oauth.redirectUrl') having count(*) = 0;
insert into PluginSetting (value, key_id) select 'https://m3demo-hallinta.otavanopisto.fi/users/logout.page?redirectUrl=https://www.google.com/accounts/Logout?continue=https://appengine.google.com/_ah/logout?continue=https://m3demo.otavanopisto.fi', (select id from PluginSettingKey where plugin = 'pyramus-oauth' and name = 'oauth.logoutUrl') from PluginSetting where key_id = (select id from PluginSettingKey where plugin = 'pyramus-oauth' and name = 'oauth.logoutUrl') having count(*) = 0;
insert into PluginSetting (value, key_id) select 'https://m3demo-hallinta.otavanopisto.fi/users/authorize.page?client_id=%s&response_type=code&redirect_uri=%s', (select id from PluginSettingKey where plugin = 'pyramus-oauth' and name = 'oauth.authUrl') from PluginSetting where key_id = (select id from PluginSettingKey where plugin = 'pyramus-oauth' and name = 'oauth.authUrl') having count(*) = 0;
insert into PluginSetting (value, key_id) select 'https://m3demo-hallinta.otavanopisto.fi/1/oauth/token', (select id from PluginSettingKey where plugin = 'pyramus-oauth' and name = 'oauth.tokenUri') from PluginSetting where key_id = (select id from PluginSettingKey where plugin = 'pyramus-oauth' and name = 'oauth.tokenUri') having count(*) = 0;
insert into PluginSetting (value, key_id) select 'https://m3demo-hallinta.otavanopisto.fi/1/system/whoami', (select id from PluginSettingKey where plugin = 'pyramus-oauth' and name = 'oauth.whoamiUrl') from PluginSetting where key_id = (select id from PluginSettingKey where plugin = 'pyramus-oauth' and name = 'oauth.whoamiUrl') having count(*) = 0;
